<h1 id="jquery-server-observer-plugin">jQuery Server Observer Plugin</h1>

<p>HTML5’s online/offline detection is a good idea but unfortunately it’s unusable. Browsers implementations are inconsistent and the specification itself <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#event-online">says</a> we can not rely on this attribute.</p>

<p>No matter what <em>online</em> means. As a web developer I only want to know if I can reach the server-side part of my application.</p>

<p>The Server Observer Plugin provides a simple and reliable way to check if the server-side application is available. Hopefully it will help people to use HTML5 offline mode.</p>

<p>Two mechanisms are used to check the server availability:</p>

<ul>
  <li>By periodically <em>pinging</em> a specified URL</li>
  <li>By observing any and all user-sent Ajax requests.</li>
</ul>

<p>Thus the client-side application will be notified of any change in the server availability.</p>

<h1 id="usage">Usage</h1>

<p>The plugin provides three operations:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">jQuery.serverObserver.enable(options)</code> - Starts observing the server availability.</p>

    <p>The <code class="highlighter-rouge">options</code> parameter is a set of key/value pairs that configure the Server Observer:</p>

    <ul>
      <li><code class="highlighter-rouge">url</code> - <em>Optional</em> - A <em>ping</em> URL on which a HEAD HTTP request will be sent to check the server availability. If no URL is provided, only user-sent Ajax requests will be observed.</li>
      <li><code class="highlighter-rouge">frequency</code> - <em>Optional, default: 3000</em> - Time between each <em>ping</em> (in milliseconds).</li>
      <li><code class="highlighter-rouge">onServerOnline</code> - Function to be called when the server becomes available.</li>
      <li><code class="highlighter-rouge">onServerOffline</code> - Function to be called when the server becomes unavailable.</li>
    </ul>
  </li>
  <li>
    <p><code class="highlighter-rouge">jQuery.serverObserver.disable()</code> - Stops the observation.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">jQuery.serverObserver.isServerOnline()</code> - Returns true if the server’s last known status is online.</p>
  </li>
</ul>

<h2 id="example">Example</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>$.serverObserver.enable({
	url: "ping",
	frequency: 5000,
	onServerOnline: function() {
		// The server is available
	},
	onServerOffline: function() {
		// The server is unavailable
	}
});
</code></pre>
</div>

<h2 id="cache">Cache</h2>

<p>Be sure to tell browsers to not cache the <em>ping</em> URL’s response by providing the correct headers.
If using the HTML5 Application Cache, make sure that the URL used for <em>pinging</em> your application is declared in the NETWORK section.</p>

<h2 id="requirements">Requirements</h2>

<p>jQuery Server Observer Plugin can be used with jQuery 1.7 and above.</p>

<h1 id="todo-list">Todo list</h1>

<ul>
  <li>Write tests</li>
</ul>

<h1 id="contributing">Contributing</h1>

<p>The Server Observer source code is hosted on GitHub.
Please feel free to report issues and submit pull requests.</p>

<h1 id="changelog">Changelog</h1>

<p><strong>v0.2</strong> - August 15th, 2012</p>

<ul>
  <li>Added the <code class="highlighter-rouge">isServerOnline</code> method</li>
</ul>

<p><strong>v0.1</strong> - May 10th, 2012</p>

<ul>
  <li>Initial release</li>
</ul>

<h1 id="license">License</h1>

<p>jQuery Server Observer Plugin is released under the MIT license (see included LICENSE file).</p>
