<!DOCTYPE HTML>

<html>

	<head>
		<title>Projet - leaspeaking</title>
		<meta charset="utf-8" />
		<meta name="description" content=""/>
		<link rel="stylesheet" href="../../css/main.css"/>
		<link rel="stylesheet" href="../../css/styles/tomorrow.css">
	</head>

	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<h1>leaspeaking</h1>
						<p><ul class="statistics">
								<li id="init_date">Created</li>
								<li id="last_update">Updated</li>
								<li id="nb_contributors">contributors</li>
								<li id="nb_commits">commits</li>
						</ul></p>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul id="summary">
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Content -->
							<section id="content" class="main">
										<!-- <span class="image main"><img src="../../images/*.ext" alt="" /></span> -->
							
								<!-- Macro Jekyll -->
										                <div class="content"> <h1 id="leaspeaking">leaspeaking</h1>
<p>Module de discussion par tweet pour Léa</p>

<h2 id="pré-requis-à-lutilisation-du-module">Pré-requis à l’utilisation du module</h2>

<h3 id="credentials-twitter">Credentials Twitter</h3>

<p>Vous devez ajouter les clés suivantes à vos variables d’environnement :</p>
<ul>
  <li><strong>TWITTER_CONSUMER_KEY</strong></li>
  <li><strong>TWITTER_CONSUMER_SECRET</strong></li>
  <li><strong>TWITTER_ACCESS_TOKEN_KEY</strong></li>
  <li><strong>TWITTER_ACCESS_TOKEN_SECRET</strong></li>
</ul>

<p>Il s’agit de vos credentials Twitter.</p>

<h3 id="installation">Installation</h3>

<p>Pour installer la partie speaker sur Ubuntu il faut ajouter</p>
<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="nx">get</span> <span class="nx">install</span> <span class="nx">libasound2</span><span class="o">-</span><span class="nx">dev</span>
</code></pre>
</div>
<p>Ensuite il suffit d’installer simplement leaspeaking ainsi</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">leaspeaking</span>
</code></pre>
</div>

<p>Pour installer la paartie speaker sur Windows il faut ajouter
npm install –global –production windows-build-tools
avoir Python =&gt; voir https://github.com/nodejs/node-gyp</p>

<h2 id="connexion-avec-lenceinte-bluetooth">Connexion avec l’enceinte bluetooth</h2>

<p>Pour configurer une connexion auto du device, il faut ajouter AutoConnect=true au fichier /etc/bluetooth/audio.conf
Si le fichier existe pas il faut le créer.
Afin d’assurer la connexion auto il faut que le démon pulseaudio soit opérationnel pour cela, taper :</p>
<div class="language-shell highlighter-rouge"><pre class="highlight"><code>pulseaudio -k <span class="o">(</span>pour l<span class="s1">'arrêter)
pulseaudio --start (pour le démarrer)
</span></code></pre>
</div>

<p>Afin de désigner notre enceinte comme enceinte par défaut</p>
<div class="highlighter-rouge"><pre class="highlight"><code>pacmd set-default-sink bluez_sink.xx_xx_xx_xx_xx_xx (où est l'adresse MAC de l'enceinte, avec des _ au lieu des :)
pacmd set-default-sink bluez_sink.40_EF_4C_DF_D5_D3 (pour notre cas précis)
</code></pre>
</div>

<p>A noter qu’il est possible de faire une connexion manuelle avec l’aide de bluetoothctl puis connect <adresseMAC></adresseMAC></p>

<h2 id="fonctionnalités-ok">Fonctionnalités OK</h2>

<ul>
  <li>Reçoit les tweets</li>
  <li>Stocke les tweets nouveau dans une file d’attente</li>
  <li>Effectue les salutations d’usage au démarrage</li>
  <li>Détecte le tweet gagnant</li>
  <li>Ecris au gagnant sur son mur Twitter</li>
  <li>Les paliers gagnants sont dynamiques</li>
  <li>Joue un son aléatoire pour chaque tweet</li>
  <li>Remercie le gagnant de façon sonore</li>
  <li>EasterEggs OK pour les ADMINS selon certains mots clés</li>
  <li>Détecter automatiquement le port de connexion</li>
  <li>Détection automatique de l’enceinte bluetooth</li>
</ul>

<h2 id="raf">RAF</h2>

<ul>
  <li>gérer le défilement du tweet =&gt; Sans objet</li>
  <li>fixer le temps d’affichage du tweet =&gt; Temps fixé par le Rpi</li>
  <li>Supprimer dans le script arduino tout les caractères non alpha-numérique</li>
</ul>

<h2 id="remarques-diverses">Remarques diverses</h2>

<p>Le code ne fonctionne que pour un Arduino Leonardo. Pour le Uno il faut utiliser la branche avec la librairie python.
L’écriture sur le port serial se fait à l’aide de python car la librairie npm serialport gère mal le DTR ce qui a pour effet de faire reseter l’arduino lors du premier appel. J’ai fais une demande de support sur leur github.
Avec le Léonardo, il est possible d’utiliser le module serialport.</p>

<p>La communication Arduino-&gt;Rpi a été testé avec succès. Donc pas de souci pour avoir un feedback de l’affichage du tweet.</p>

 </div>                                              

							</section>

					</div>

				<!-- Footer -->
					<footer id="footer">
						<p class="copyright"><a href="http://www.sqli.com/"><img src="../../images/logo_sqli.png" height="24" width="44" style="vertical-align: middle; border: 0px"></a> | SQLi Nantes &copy; 2017 - CC-BY-SA 4.0. Design: <a href="https://html5up.net">HTML5 UP</a> modified by <a href="https://github.com/maximegrnd">Maxime GRAND</a>.</p>
					</footer>

			</div>

		<!-- Scripts -->
			<script type="text/javascript" src="../../js/jquery.min.js"></script>
			<script type="text/javascript" src="../../js/jquery.scrollex.min.js"></script>
			<script type="text/javascript" src="../../js/jquery.scrolly.min.js"></script>
			<script type="text/javascript" src="../../js/skel.min.js"></script>
			<script type="text/javascript" src="../../js/util.js"></script>
			<script type="text/javascript" src="../../js/main.js"></script>
			<script type="text/javascript" src="../../js/url_request.js"></script>
			<script type="text/javascript" src="js/data_leaspeaking.js"></script>
			<script type="text/javascript" src="../../js/generate_summary.js"></script>
			<script type="text/javascript" src="../../js/highlight.pack.js"></script>
			<script>hljs.initHighlightingOnLoad();</script>

	</body>
</html>